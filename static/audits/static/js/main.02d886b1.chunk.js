(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{145:function(e,t){},285:function(e,t,a){e.exports=a(939)},290:function(e,t,a){},296:function(e,t,a){},301:function(e,t,a){},303:function(e,t,a){},503:function(e,t,a){},505:function(e,t,a){},507:function(e,t,a){},509:function(e,t,a){},934:function(e,t,a){},936:function(e,t,a){},939:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(133),i=a.n(s),o=(a(290),a(292),a(3)),c=a.n(o),u=a(11),l=a(27),d=a(28),m=a(30),p=a(29),h=a(31),f=a(108),g=a(948),v=a(964),b=a(954),w=a(955),E=a(956),y=a(957),k=a(958),C=a(959),O=a(960),x=a(951),S=(a(296),a(963)),j=a(941),I=a(62),A=function(e){var t=e.component,a=e.props,n=Object(I.a)(e,["component","props"]);return r.a.createElement(j.a,Object.assign({},n,{render:function(e){return r.a.createElement(t,Object.assign({},e,a))}}))},N=a(942),P=(a(301),a(303),function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).convertPropsToState=function(e){var t=e.percent,n="0deg",r="0deg";t>=50?(r="180deg",n=3.6*(t-50)+"deg"):(r=3.6*t+"deg",n="0deg"),a.setState({percent:e.percent,borderWidth:e.borderWidth<2||!e.borderWidth?2:e.borderWidth,leftTransformerDegree:n,rightTransformerDegree:r})},a.state={percent:0,borderWidth:8,leftTransformerDegree:"0deg",rightTransformerDegree:"0deg"},a}return Object(h.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){this.convertPropsToState(this.props)}},{key:"componentWillReceiveProps",value:function(e){this.props.percent!==e.percent&&this.convertPropsToState(e)}},{key:"render",value:function(){return r.a.createElement("div",{className:"circle",style:{width:2*this.props.radius,height:2*this.props.radius,borderRadius:this.props.radius,backgroundColor:this.props.bgcolor}},r.a.createElement("div",{className:"left-wrap",style:{width:this.props.radius,height:2*this.props.radius,left:0}},r.a.createElement("div",{className:"loader",id:"id1",style:{left:this.props.radius,width:this.props.radius,height:2*this.props.radius,borderTopLeftRadius:0,borderBottomLeftRadius:0,backgroundColor:this.props.color,transform:"rotate("+this.state.leftTransformerDegree+")"}})),r.a.createElement("div",{className:"right-wrap",style:{width:this.props.radius,height:2*this.props.radius,left:this.props.radius}},r.a.createElement("div",{className:"loader2",id:"id2",style:{left:-this.props.radius,width:this.props.radius,height:2*this.props.radius,borderTopRightRadius:0,borderBottomRightRadius:0,backgroundColor:this.props.color,transform:"rotate("+this.state.rightTransformerDegree+")"}})),r.a.createElement("div",{className:"inner-circle",style:{left:this.props.borderWidth,top:this.props.borderWidth,width:2*(this.props.radius-this.props.borderWidth),height:2*(this.props.radius-this.props.borderWidth),borderRadius:this.props.radius-this.props.borderWidth,backgroundColor:this.props.innerColor}},this.props.children?this.props.children:r.a.createElement("span",{className:"text "+this.props.textStyle},this.props.percent,"%")))}}]),t}(n.Component));P.defaultProps={color:"#000",radius:20,percent:0,borderWidth:2,bgcolor:"#e3e3e3",innerColor:"#fff",disabled:!1,textStyle:""};var q=P,L=a(965),D=function(e){var t=e.error;return t?r.a.createElement(L.a,{className:"pl-0 pr-0",color:"danger"},t):null},T=a(20),F=a.n(T),R=function(e){var t,a,n,r,s,i;for(t="",n=e.length,a=0;a<n;)switch((r=e[a++])>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:t+=String.fromCharCode(r);break;case 12:case 13:s=e[a++],t+=String.fromCharCode((31&r)<<6|63&s);break;case 14:s=e[a++],i=e[a++],t+=String.fromCharCode((15&r)<<12|(63&s)<<6|(63&i)<<0)}return t},W=function(){var e=Object(u.a)(c.a.mark(function e(t){var a;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T.Storage.get(t,{download:!0,expires:36e5});case 2:return a=e.sent,e.abrupt("return",JSON.parse(R(a.Body)));case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),U=function(){var e=Object(u.a)(c.a.mark(function e(t){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",T.API.post("audits","/audits",{body:t}));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),_=function(){var e=Object(u.a)(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",T.API.get("audits","/audits"));case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),V=function(){var e=Object(u.a)(c.a.mark(function e(t){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",T.API.get("audits","/audits/".concat(t)));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),J=function(){var e=Object(u.a)(c.a.mark(function e(t,a){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",T.API.put("audits","/audits/".concat(t),{body:a}));case 1:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}(),G=function(){var e=Object(u.a)(c.a.mark(function e(){var t;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return T.Cache.setItem("auditData",[]),e.next=3,W("audit.json");case 3:return t=e.sent,T.Cache.setItem("auditData",t,{expires:36e5}),e.abrupt("return",t);case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),H=function(){var e=Object(u.a)(c.a.mark(function e(t){var a;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y();case 2:return a=e.sent,e.abrupt("return",K(a,t));case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),M=function(){var e=Object(u.a)(c.a.mark(function e(){var t;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_();case 2:return t=e.sent,e.abrupt("return",$(t));case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),B=function(){var e=Object(u.a)(c.a.mark(function e(){var t,a;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_();case 2:return t=e.sent,e.next=5,Y();case 5:return a=e.sent,e.abrupt("return",t.map(function(e){return z(a,e)}));case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),Q=function(){var e=Object(u.a)(c.a.mark(function e(t){var a,n,r;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,H(t);case 2:return a=e.sent,n=X(a.pages),r={auditId:t,auditAnswers:JSON.stringify(n)},e.abrupt("return",U(r));case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),Y=function(){var e=Object(u.a)(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",T.Cache.getItem("auditData",{callback:G}));case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),$=function(){var e=Object(u.a)(c.a.mark(function e(t){var a,n,r;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.map(function(e){return e.auditId}),e.next=3,Y();case 3:return n=e.sent,r=n.filter(function(e){return!a.includes(e.auditId)}),e.abrupt("return",r);case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),z=function(e,t){var a=K(e,t.auditId),n=Math.round(t.currentPage/a.pages.length*100);return t.complete&&(n=100),{title:a.title,description:a.description,percentageComplete:n,lastEditTime:t.lastEditTime,auditAnswersId:t.auditAnswersId}},K=function(e,t){var a=e.filter(function(e){return e.auditId===t});if(1!==a.length)throw new Error("Could not find audit with id"+t);return a[0]},X=function(e){var t={};return e.forEach(function(e){t[e.pageId]=Z(e.questions)}),t},Z=function(e){var t={};return e.forEach(function(e){t[e.questionId]=""}),t},ee=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).state={isLoading:!0,unstartedAudits:[],inProgressAudits:[],error:null},a}return Object(h.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){var e=Object(u.a)(c.a.mark(function e(){var t,a;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.isAuthenticated){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,M();case 5:return t=e.sent,e.next=8,B();case 8:a=e.sent,this.setState({inProgressAudits:a,unstartedAudits:t,error:null}),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(2),this.setState({error:e.t0.message}),console.error("Could not mount audit Home",e.t0);case 16:this.setState({isLoading:!1});case 17:case"end":return e.stop()}},e,this,[[2,12]])}));return function(){return e.apply(this,arguments)}}()},{key:"createNewAudit",value:function(){var e=Object(u.a)(c.a.mark(function e(t){var a;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({isLoading:!0,error:null}),e.prev=1,e.next=4,Q(t.auditId);case 4:a=e.sent,this.props.history.push("".concat("/audits","/#/id/").concat(a.auditAnswersId)),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(1),this.setState({error:e.t0.message}),console.error("Could not create new audit",e.t0);case 12:this.setState({isLoading:!1});case 13:case"end":return e.stop()}},e,this,[[1,8]])}));return function(t){return e.apply(this,arguments)}}()},{key:"renderUnstartedAudits",value:function(){var e=this,t=this.state.unstartedAudits;return 0===t.length?r.a.createElement("div",null):r.a.createElement(N.a,{list:!0,className:"audits pl-0 pb-sm-3"},r.a.createElement("h3",null,"Start a new audit"),r.a.createElement("div",{className:"mb-2"},"These are new audits that you can choose to start."),t.map(function(t,a){return r.a.createElement(N.a,{className:"mb-3 hoverable",href:"#",onClick:function(){return e.createNewAudit(t)},key:a},r.a.createElement(N.a,{className:"align-self-center mr-sm-4 mr-1"},r.a.createElement(q,{radius:40,borderWidth:8,bgcolor:"#ffc107"},r.a.createElement("span",{className:"display-4 text","aria-hidden":!0},"\uff0b"))),r.a.createElement(N.a,{body:!0},r.a.createElement(N.a,{heading:!0},t.title),r.a.createElement("div",null,t.description)))}))}},{key:"renderInProgressAudits",value:function(){var e=this.state.inProgressAudits;return 0===e.length?r.a.createElement("div",null):r.a.createElement(N.a,{list:!0,className:"audits pl-0"},r.a.createElement("h3",null,"Your existing audits"),r.a.createElement("div",{className:"mb-2"},"These are audits that are in progress or ones you have completed with the advice we provide."),e.map(function(e,t){return r.a.createElement(N.a,{className:"mb-3 hoverable",href:"".concat("/audits","/#/id/").concat(e.auditAnswersId),key:t},r.a.createElement(N.a,{className:"align-self-center mr-sm-4 mr-1"},r.a.createElement(q,{radius:40,borderWidth:8,percent:e.percentageComplete,color:"#007bff"})),r.a.createElement(N.a,{body:!0},r.a.createElement(N.a,{heading:!0},e.title),r.a.createElement("div",null,e.description),r.a.createElement("small",{className:"text-muted"},"Updated "+new Date(e.lastEditTime).toLocaleDateString())))}))}},{key:"renderLander",value:function(){return r.a.createElement("div",{className:"lander"},r.a.createElement("h1",null,"Innovation Unboxed Audit"),r.a.createElement("p",null,"Audit your organisation to help identify and track your technical needs."),r.a.createElement("p",null,"Please register an account, or sign in to complete an audit"))}},{key:"renderAudits",value:function(){return this.state.isLoading?r.a.createElement("div",null,"Loading..."):r.a.createElement("div",null,this.renderUnstartedAudits(),this.renderInProgressAudits())}},{key:"render",value:function(){return r.a.createElement("div",{className:"Home"},r.a.createElement(D,{error:this.state.error}),this.props.isAuthenticated?this.renderAudits():this.renderLander())}}]),t}(n.Component),te=a(54),ae=a(944),ne=a(945),re=a(946),se=a(947),ie=(a(503),a(943)),oe=(a(505),a(139)),ce=function(e){var t=e.isLoading,a=e.text,n=e.loadingText,s=e.className,i=void 0===s?"":s,o=e.disabled,c=void 0!==o&&o,u=Object(I.a)(e,["isLoading","text","loadingText","className","disabled"]);return r.a.createElement(ie.a,Object.assign({className:"LoaderButton ".concat(i),disabled:c||t},u),t&&r.a.createElement(oe.a,{size:"1.8em",className:"spinning"}),t?n:a)},ue=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).handleChange=function(e){a.setState(Object(te.a)({},e.target.id,e.target.value))},a.handleSubmit=function(){var e=Object(u.a)(c.a.mark(function e(t){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),a.setState({isLoading:!0,error:null}),e.prev=2,e.next=5,T.Auth.signIn(a.state.email,a.state.password);case 5:a.props.userHasAuthenticated(!0),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(2),console.error(e.t0.message),a.setState({isLoading:!1,error:e.t0.message});case 12:case"end":return e.stop()}},e,this,[[2,8]])}));return function(t){return e.apply(this,arguments)}}(),a.state={isLoading:!1,email:"",password:"",error:null},a}return Object(h.a)(t,e),Object(d.a)(t,[{key:"validateForm",value:function(){return this.state.email.length>0&&this.state.password.length>0}},{key:"render",value:function(){return r.a.createElement("div",{className:"Login"},r.a.createElement(D,{error:this.state.error}),r.a.createElement(ae.a,{className:"mt-5",onSubmit:this.handleSubmit},r.a.createElement(ne.a,null,r.a.createElement(re.a,{for:"email"},"Email"),r.a.createElement(se.a,{id:"email",type:"email",defaultValue:this.state.email,onChange:this.handleChange})),r.a.createElement(ne.a,null,r.a.createElement(re.a,{for:"password"},"Password"),r.a.createElement(se.a,{id:"password",name:"password",defaultValue:this.state.password,onChange:this.handleChange,type:"password"})),r.a.createElement(g.a,{to:"/login/reset"},"Forgot password?"),r.a.createElement(ce,{block:!0,disabled:!this.validateForm(),type:"submit",isLoading:this.state.isLoading,text:"Login",loadingText:"Logging in..."})))}}]),t}(n.Component),le=a(949),de=(a(507),function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).handleChange=function(e){a.setState(Object(te.a)({},e.target.id,e.target.value))},a.handleSubmit=function(){var e=Object(u.a)(c.a.mark(function e(t){var n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),a.setState({isLoading:!0,error:null}),e.prev=2,e.next=5,T.Auth.signUp({username:a.state.email,password:a.state.password});case 5:n=e.sent,a.setState({newUser:n}),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(2),console.error(e.t0.message),a.setState({isLoading:!1,error:e.t0.message});case 13:a.setState({isLoading:!1});case 14:case"end":return e.stop()}},e,this,[[2,9]])}));return function(t){return e.apply(this,arguments)}}(),a.handleConfirmationSubmit=function(){var e=Object(u.a)(c.a.mark(function e(t){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),a.setState({isLoading:!0,error:null}),e.prev=2,e.next=5,T.Auth.confirmSignUp(a.state.email,a.state.confirmationCode);case 5:return e.next=7,T.Auth.signIn(a.state.email,a.state.password);case 7:a.props.userHasAuthenticated(!0),a.props.history.push("/"),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(2),console.error("Could not signin to account",e.t0.message),a.setState({isLoading:!1,error:e.t0.message});case 15:case"end":return e.stop()}},e,this,[[2,11]])}));return function(t){return e.apply(this,arguments)}}(),a.state={isLoading:!1,email:"",password:"",confirmPassword:"",confirmationCode:"",newUser:null,error:null},a}return Object(h.a)(t,e),Object(d.a)(t,[{key:"validateForm",value:function(){return this.state.email.length>0&&this.state.password.length>0&&this.state.password===this.state.confirmPassword}},{key:"validateConfirmationForm",value:function(){return this.state.confirmationCode.length>0}},{key:"renderConfirmationForm",value:function(){return r.a.createElement(ae.a,{className:"mt-5",onSubmit:this.handleConfirmationSubmit},r.a.createElement(ne.a,null,r.a.createElement(re.a,{for:"confirmationCode"},"Confirmation Code"),r.a.createElement(se.a,{id:"confirmationCode",name:"confirmationCode",autoFocus:!0,type:"tel",defaultValue:this.state.confirmationCode,onChange:this.handleChange}),r.a.createElement(le.a,{color:"muted"},"Please check your email for the code.")),r.a.createElement(ce,{block:!0,disabled:!this.validateConfirmationForm(),type:"submit",isLoading:this.state.isLoading,text:"Verify",loadingText:"Verifying..."}))}},{key:"renderForm",value:function(){return r.a.createElement(ae.a,{className:"mt-5",onSubmit:this.handleSubmit},r.a.createElement(ne.a,null,r.a.createElement(re.a,{for:"email"},"Email"),r.a.createElement(se.a,{autoFocus:!0,type:"email",name:"email",id:"email",defaultValue:this.state.email,onChange:this.handleChange})),r.a.createElement(ne.a,null,r.a.createElement(re.a,{for:"password"},"Password"),r.a.createElement(se.a,{name:"password",id:"password",defaultValue:this.state.password,onChange:this.handleChange,type:"password"})),r.a.createElement(ne.a,null,r.a.createElement(re.a,{for:"confirmPassword"},"Confirm Password"),r.a.createElement(se.a,{name:"confirmPassword",id:"confirmPassword",defaultValue:this.state.confirmPassword,onChange:this.handleChange,type:"password"})),r.a.createElement(ce,{block:!0,bsSize:"large",disabled:!this.validateForm(),type:"submit",isLoading:this.state.isLoading,text:"Register",loadingText:"Register account..."}))}},{key:"render",value:function(){return r.a.createElement("div",{className:"Signup"},r.a.createElement(D,{error:this.state.error}),null===this.state.newUser?this.renderForm():this.renderConfirmationForm())}}]),t}(n.Component)),me=a(950),pe=function(e){var t=e.answer,a=e.name,n=e.inline,s=e.selected;Object(I.a)(e,["answer","name","inline","selected"]);return r.a.createElement(ne.a,{className:"",check:!0,inline:n},r.a.createElement(re.a,{for:a,check:!0,className:"col-form-label"},r.a.createElement(se.a,{type:"radio",name:a,defaultChecked:s,value:t,key:a})," ",t))},he=function(e){var t=e.questionId,a=e.question,n=e.required,s=e.answers,i=e.selectedAnswer,o=e.inline;return r.a.createElement(ne.a,{className:"bg-warning",row:!0},r.a.createElement(re.a,{for:t,sm:4},a," ",n?null:r.a.createElement("p",null,"(optional)")),r.a.createElement(me.a,{sm:8},s.map(function(e,a){return r.a.createElement(pe,{selected:e===i,inline:o,name:t,answer:e,key:t+"-"+a})})))},fe=function(e){var t=e.questionId,a=e.question,n=e.required,s=e.answer;return r.a.createElement(ne.a,{className:"bg-warning py-sm-1",row:!0},r.a.createElement(re.a,{for:t,sm:4},a," ",n?null:r.a.createElement("p",null,"(optional)")),r.a.createElement(me.a,{sm:8},r.a.createElement(se.a,{className:"mb-2 mb-sm-0",type:"textarea",name:t,id:t,defaultValue:s})))},ge=function(e){var t=e.questionId,a=e.question,n=e.required,s=e.answer;return r.a.createElement(ne.a,{className:"bg-warning py-sm-1",row:!0},r.a.createElement(re.a,{for:t,sm:4},a," ",n?null:r.a.createElement("p",null,"(optional)")),r.a.createElement(me.a,{sm:8},r.a.createElement(se.a,{className:"mb-2 mb-sm-0",type:"text",name:t,id:t,defaultValue:s})))},ve=function(e){var t=e.questionId,a=e.question,n=e.required,s=e.answers,i=e.selectedAnswer;return r.a.createElement(ne.a,{className:"bg-warning",row:!0},r.a.createElement(re.a,{for:t,sm:4},a," ",n?null:r.a.createElement("p",null,"(optional)")),r.a.createElement(me.a,{sm:8},r.a.createElement(se.a,{className:"mb-2 mb-sm-0",type:"select",name:t,id:t,defaultValue:i},s.map(function(e,a){return r.a.createElement("option",{key:t+"-"+a},e)}))))},be=a(952),we=(a(509),function(e){var t=e.input,a=e.className;return r.a.createElement("div",{className:"Paragraphs "+a},t.split("\n").map(function(e,t){return r.a.createElement("p",{key:t},e)}))}),Ee=a(138),ye=a.n(Ee),ke=function(e){function t(e){var a;Object(l.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).handleSubmit=function(){var e=Object(u.a)(c.a.mark(function e(t){var n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n={pageId:a.pageData.pageId,answers:a.state.answers},t(n);case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),a.preventEnter=function(e){e.preventDefault()},a.handleChange=function(){var e=Object(u.a)(c.a.mark(function e(t){var n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=ye()(a.state.answers,Object(te.a)({},t.target.name,{$set:t.target.value})),a.setState({answers:n});case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),a.getQuestionFromId=function(e){var t=a.pageData.questions.filter(function(t){return t.questionId===e});if(1!==t.length)throw new Error("Could not find single question matching question id "+e+" from "+JSON.stringify(a.pageData));return t[0]},a.unansweredQuestions=function(){var e=Object.keys(a.state.answers),t=!1;return e.forEach(function(e){a.getQuestionFromId(e).required&&""===a.state.answers[e]&&(t=!0)}),t},a.renderQuestions=function(e){return e.map(function(e,t){return"radio"===e.type?r.a.createElement(he,{key:t,questionId:e.questionId,question:e.question,required:e.required,answers:e.answers,selectedAnswer:a.state.answers[e.questionId],inline:!0}):"textarea"===e.type?r.a.createElement(fe,{key:t,questionId:e.questionId,question:e.question,required:e.required,answer:a.state.answers[e.questionId]}):"text"===e.type?r.a.createElement(ge,{key:t,questionId:e.questionId,question:e.question,required:e.required,answer:a.state.answers[e.questionId]}):"select"===e.type?r.a.createElement(ve,{key:t,questionId:e.questionId,question:e.question,required:e.required,answers:e.answers,selectedAnswer:a.state.answers[e.questionId],inline:!0}):r.a.createElement("div",null,"no questions")})};var n=e.pageData,s=e.answers,i=e.previous,o=e.next,d=e.quit;return a.pageData=n,a.previous=i,a.next=o,a.quit=d,a.state={answers:s},a}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement(x.a,null,r.a.createElement("h2",null,this.pageData.title),r.a.createElement(we,{input:this.pageData.description}),r.a.createElement(ae.a,{onSubmit:this.preventEnter,onChange:this.handleChange},this.renderQuestions(this.pageData.questions),r.a.createElement(ne.a,{inline:!0,row:!0},r.a.createElement(be.a,{sm:{offset:0}},null!==this.previous?r.a.createElement(ie.a,{onClick:function(){return e.handleSubmit(e.previous)}},"Previous"):null,null!==this.next?r.a.createElement(ie.a,{disabled:this.unansweredQuestions(),onClick:function(){return e.handleSubmit(e.next)}},"Next"):r.a.createElement(ie.a,{color:"warning",disabled:this.unansweredQuestions(),onClick:function(){return e.handleSubmit(e.quit)}},"Complete")))))}}]),t}(n.Component),Ce=a(140),Oe=function(){var e=Object(u.a)(c.a.mark(function e(){var t;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return T.Cache.setItem("adviceData",[]),e.next=3,W("advice.json");case 3:return t=e.sent,T.Cache.setItem("adviceData",t,{expires:36e5}),e.abrupt("return",t);case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),xe=function(){var e=Object(u.a)(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",T.Cache.getItem("adviceData",{callback:Oe}));case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),Se=function(){var e=Object(u.a)(c.a.mark(function e(t){var a,n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,xe();case 2:if(a=e.sent,1===(n=a.filter(function(e){return e.auditId===t})).length){e.next=6;break}throw new Error("Could not find advice with auditId "+t);case 6:return e.abrupt("return",n[0]);case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),je=function(e,t){var a={};return Object.keys(e).forEach(function(n){var r=t[n];if(r){var s=r[e[n]];a[n]=s}}),a},Ie=function(e,t){var a={x:e},n=Object.keys(t).find(function(e){return Ce.eval(e,a)});if(!n)throw new Error("Expected to match a score of "+e+" from results "+JSON.stringify(t));return t[n]},Ae=function(){var e=Object(u.a)(c.a.mark(function e(t,a){var n,r,s,i,o;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Se(t.auditId);case 2:if(n=e.sent,r={},s={},Object.keys(a).forEach(function(e){var t=a[e],i=Ne(n,e);if(i){var o=i.scores,c=i.formula,u=i.results;if(o&&c){var l=je(t,o),d=Ce.eval(c,l);s[e]=d;var m=Ie(d,u);r[e]={score:d,result:m}}else i.default?r[e]={result:i.default}:console.warn("There is no advice defined for page "+e)}}),!n.summary){e.next=10;break}n.summary.default?r.summary={result:n.summary.default}:(i=Ce.eval(n.summary.formula,s),o=Ie(i,n.summary.results),r.summary={score:i,result:o}),e.next=11;break;case 10:throw new Error("Invalid advice data, no summary section "+JSON.stringify(n));case 11:return e.abrupt("return",r);case 12:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}(),Ne=function(e,t){var a=e.pages.filter(function(e){return e.pageId===t});return 1===a.length?a[0]:null},Pe=function(e){function t(e){var a;Object(l.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).next=function(){a.setState({page:a.state.page+1})},a.previous=function(){a.setState({page:a.state.page-1})},a.renderScore=function(e){if(console.log("Score is ",e),!("undefined"===typeof e||null===e||e<0))return r.a.createElement(q,{radius:40,borderWidth:8,percent:Math.round(e),color:"#007bff"})};var n=e.audit,s=e.auditAnswers,i=e.edit;return a.audit=n,a.edit=i,a.state={auditAnswers:s,advice:null,page:0,error:null},a}return Object(h.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){var e=Object(u.a)(c.a.mark(function e(){var t;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Ae(this.audit,this.state.auditAnswers);case 3:t=e.sent,this.setState({advice:t}),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),this.setState({error:e.t0.message}),console.error("Could not mount audit Advice",e.t0);case 11:case"end":return e.stop()}},e,this,[[0,7]])}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){if(!this.state.advice)return r.a.createElement(x.a,null,r.a.createElement(D,{error:this.state.error}),r.a.createElement("div",null,"Loading..."));var e=Object.keys(this.state.advice),t=e[this.state.page],a=this.state.advice[t],n=Ne(this.audit,t);return n||(n={title:"Summary",description:this.audit.description}),r.a.createElement(x.a,null,r.a.createElement(D,{error:this.state.error}),r.a.createElement("h2",null,"Advice for ",this.audit.title),r.a.createElement(N.a,{className:"mt-4"},r.a.createElement(N.a,{className:"align-self-center mr-sm-4 mr-1"},this.renderScore(a.score)),r.a.createElement(N.a,{body:!0},r.a.createElement(N.a,{heading:!0},n.title),r.a.createElement("div",null,n.description))),r.a.createElement(we,{className:"mt-4",input:a.result}),r.a.createElement(ne.a,{inline:!0,row:!0},r.a.createElement(be.a,{sm:{offset:0}},this.state.page-1>=0?r.a.createElement(ie.a,{onClick:this.previous},"Previous"):null,this.state.page+1<e.length?r.a.createElement(ie.a,{onClick:this.next},"Next"):r.a.createElement(ie.a,{color:"warning",tag:g.a,to:"/"},"Close Advice"),r.a.createElement(ie.a,{color:"danger",onClick:this.edit},"Edit my answers"))))}}]),t}(n.Component),qe=a(953),Le=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).toggleCompletedStateOfAudit=function(e){console.log("Setting completed state to "+!a.state.complete),a.saveSubmittedAnswers(e,a.state.currentPage,!a.state.complete).then(function(){return a.setState({complete:!a.state.complete})}).catch(function(e){return a.handleError(e)})},a.previousPage=function(e){var t=a.state.currentPage-1;a.saveSubmittedAnswers(e,t,a.state.complete).then(function(){return a.setState({currentPage:t})}).catch(function(e){return a.handleError(e)})},a.nextPage=function(e){var t=a.state.currentPage+1;a.saveSubmittedAnswers(e,t,a.state.complete).then(function(){return a.setState({currentPage:t})}).catch(function(e){return a.handleError(e)})},a.saveSubmittedAnswers=function(){var e=Object(u.a)(c.a.mark(function e(t,n,r){var s,i;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s=ye()(a.state.auditAnswers,Object(te.a)({},t.pageId,{$set:t.answers})),a.setState({auditAnswers:s,error:null}),i={currentPage:n,auditAnswers:JSON.stringify(s),complete:r},e.next=5,J(a.props.match.params.id,i);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}},e,this)}));return function(t,a,n){return e.apply(this,arguments)}}(),a.state={audit:null,currentPage:null,auditAnswers:null,complete:!1,error:null},a}return Object(h.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){var e=Object(u.a)(c.a.mark(function e(){var t,a,n,r,s;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,V(this.props.match.params.id);case 3:return t=e.sent,a=t.auditAnswers,n=t.currentPage,r=t.complete,e.next=7,H(t.auditId);case 7:s=e.sent,this.setState({audit:s,currentPage:n,auditAnswers:JSON.parse(a),complete:r,error:null}),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(0),e.t0.message="Could not load audit with id "+this.props.match.params.id,this.handleError(e.t0);case 15:case"end":return e.stop()}},e,this,[[0,11]])}));return function(){return e.apply(this,arguments)}}()},{key:"handleError",value:function(e){this.setState({error:e.message}),console.error("Could not render Audit",e)}},{key:"render",value:function(){if(!this.state.auditAnswers)return r.a.createElement(x.a,null,r.a.createElement(D,{error:this.state.error}),r.a.createElement("div",null,"Loading..."));var e=this.state.audit.pages.length,t=this.state.currentPage,a=this.state.audit.pages[t],n=t-1>=0?this.previousPage:null,s=t+1<e?this.nextPage:null,i=t+1>=e?this.toggleCompletedStateOfAudit:null;if(this.state.complete&&i)return r.a.createElement(Pe,{key:a.pageId,auditAnswers:this.state.auditAnswers,audit:this.state.audit,edit:i});var o=this.state.auditAnswers[a.pageId];return r.a.createElement(x.a,null,r.a.createElement(D,{error:this.state.error}),r.a.createElement(ke,{key:a.pageId,answers:o,pageData:a,previous:n,next:s,quit:i}),r.a.createElement(qe.a,{value:(t+1)/e*100},"Page ",t+1))}}]),t}(n.Component),De=(a(934),function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).handleChange=function(e){a.setState(Object(te.a)({},e.target.id,e.target.value))},a.handleSendCodeClick=function(){var e=Object(u.a)(c.a.mark(function e(t){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),a.setState({isSendingCode:!0,error:null}),e.prev=2,e.next=5,T.Auth.forgotPassword(a.state.email);case 5:a.setState({codeSent:!0}),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(2),console.error("Could not send forgotten password code",e.t0.message),a.setState({isSendingCode:!1,error:e.t0.message});case 12:case"end":return e.stop()}},e,this,[[2,8]])}));return function(t){return e.apply(this,arguments)}}(),a.handleConfirmClick=function(){var e=Object(u.a)(c.a.mark(function e(t){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),a.setState({isConfirming:!0,error:null}),e.prev=2,e.next=5,T.Auth.forgotPasswordSubmit(a.state.email,a.state.code,a.state.password);case 5:a.setState({confirmed:!0}),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(2),console.error("Could not submit forgotten password",e.t0.message),a.setState({isConfirming:!1,error:e.t0.message});case 12:case"end":return e.stop()}},e,this,[[2,8]])}));return function(t){return e.apply(this,arguments)}}(),a.state={code:"",email:"",password:"",codeSent:!1,confirmed:!1,confirmPassword:"",isConfirming:!1,isSendingCode:!1,error:null},a}return Object(h.a)(t,e),Object(d.a)(t,[{key:"validateCodeForm",value:function(){return this.state.email.length>0}},{key:"validateResetForm",value:function(){return this.state.code.length>0&&this.state.password.length>0&&this.state.password===this.state.confirmPassword}},{key:"renderRequestCodeForm",value:function(){return r.a.createElement(ae.a,{className:"mt-5",onSubmit:this.handleSendCodeClick},r.a.createElement(ne.a,null,r.a.createElement(re.a,{for:"email"},"Email"),r.a.createElement(se.a,{id:"email",name:"email",autoFocus:!0,type:"email",value:this.state.email,onChange:this.handleChange})),r.a.createElement(ce,{block:!0,type:"submit",loadingText:"Sending...",text:"Send Confirmation",isLoading:this.state.isSendingCode,disabled:!this.validateCodeForm()}))}},{key:"renderConfirmationForm",value:function(){return r.a.createElement(ae.a,{className:"mt-5",onSubmit:this.handleConfirmClick},r.a.createElement(ne.a,null,r.a.createElement(re.a,{for:"code"},"Confirmation Code"),r.a.createElement(se.a,{id:"code",name:"code",autoFocus:!0,type:"tel",value:this.state.code,onChange:this.handleChange}),r.a.createElement(le.a,null,"Please check your email (",this.state.email,") for the confirmation code.")),r.a.createElement("hr",null),r.a.createElement(ne.a,null,r.a.createElement(re.a,{for:"password"},"New Password"),r.a.createElement(se.a,{id:"password",name:"password",type:"password",value:this.state.password,onChange:this.handleChange})),r.a.createElement(ne.a,null,r.a.createElement(re.a,{for:"confirmPassword"},"Confirm Password"),r.a.createElement(se.a,{id:"confirmPassword",name:"confirmPassword",type:"password",onChange:this.handleChange,value:this.state.confirmPassword})),r.a.createElement(ce,{block:!0,type:"submit",text:"Confirm",loadingText:"Confirm...",isLoading:this.state.isConfirming,disabled:!this.validateResetForm()}))}},{key:"renderSuccessMessage",value:function(){return r.a.createElement("div",{className:"success mt-5"},r.a.createElement(oe.b,{size:"1.8em"}),r.a.createElement("p",null,"Your password has been reset."),r.a.createElement("p",null,r.a.createElement(g.a,{to:"/login"},"Click here to login with your new credentials.")))}},{key:"render",value:function(){return r.a.createElement("div",{className:"ResetPassword"},r.a.createElement(D,{error:this.state.error}),this.state.codeSent?this.state.confirmed?this.renderSuccessMessage():this.renderConfirmationForm():this.renderRequestCodeForm())}}]),t}(n.Component)),Te=(a(936),function(){return r.a.createElement("div",{className:"NotFound"},r.a.createElement("h3",null,"Sorry, page not found!"))}),Fe=a(961),Re=function(e){var t=e.component,a=e.props,n=Object(I.a)(e,["component","props"]);return r.a.createElement(j.a,Object.assign({},n,{render:function(e){return a.isAuthenticated?r.a.createElement(t,Object.assign({},e,a)):r.a.createElement(Fe.a,{to:"/login?redirect=".concat(e.location.pathname).concat(e.location.search)})}}))};var We=function(e){var t=e.component,a=e.props,n=Object(I.a)(e,["component","props"]),s=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window.location.href;e=e.replace(/[[]]/g,"\\$&");var a=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)","i").exec(t);return a?a[2]?decodeURIComponent(a[2].replace(/\+/g," ")):"":null}("redirect");return r.a.createElement(j.a,Object.assign({},n,{render:function(e){return a.isAuthenticated?r.a.createElement(Fe.a,{to:""===s||null===s?"/":s}):r.a.createElement(t,Object.assign({},e,a))}}))},Ue=function(e){var t=e.childProps;return r.a.createElement(S.a,null,r.a.createElement(A,{path:"/",exact:!0,component:ee,props:t}),r.a.createElement(We,{path:"/login",exact:!0,component:ue,props:t}),r.a.createElement(We,{path:"/signup",exact:!0,component:de,props:t}),r.a.createElement(Re,{path:"/id/:id",exact:!0,component:Le,props:t}),r.a.createElement(We,{path:"/login/reset",exact:!0,component:De,props:t}),r.a.createElement(j.a,{component:Te}))},_e=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).userHasAuthenticated=function(e){a.setState({isAuthenticated:e})},a.handleLogout=function(){var e=Object(u.a)(c.a.mark(function e(t){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T.Auth.signOut();case 2:a.userHasAuthenticated(!1),a.props.history.push("/login");case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),a.toggle=a.toggle.bind(Object(f.a)(Object(f.a)(a))),a.state={navIsOpen:!1,isAuthenticated:!1,isAuthenticating:!0,error:null},a}return Object(h.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){var e=Object(u.a)(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,T.Auth.currentSession();case 3:this.userHasAuthenticated(!0),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),"No current user"!==e.t0&&(console.error(e.t0),this.setState({error:e.t0.message}));case 9:this.setState({isAuthenticating:!1,error:null});case 10:case"end":return e.stop()}},e,this,[[0,6]])}));return function(){return e.apply(this,arguments)}}()},{key:"toggle",value:function(){this.setState({navIsOpen:!this.state.navIsOpen})}},{key:"render",value:function(){var e={isAuthenticated:this.state.isAuthenticated,userHasAuthenticated:this.userHasAuthenticated};return!this.state.isAuthenticating&&r.a.createElement("div",null,r.a.createElement(b.a,{color:"dark",dark:!0,expand:"md"},r.a.createElement(w.a,{tag:g.a,to:"/"},"Innovation Unboxed Audit"),r.a.createElement(E.a,{onClick:this.toggle}),r.a.createElement(y.a,{isOpen:this.state.navIsOpen,navbar:!0},r.a.createElement(k.a,{className:"ml-auto",navbar:!0},this.state.isAuthenticated?r.a.createElement(C.a,{onClick:this.handleLogout},"Logout"):r.a.createElement(n.Fragment,null,r.a.createElement(C.a,null,r.a.createElement(O.a,{tag:g.a,to:"/signup"},"Signup")),r.a.createElement(C.a,null,r.a.createElement(O.a,{tag:g.a,to:"/login"},"Login")))))),r.a.createElement(x.a,{className:"App"},r.a.createElement("div",null,this.state.error),r.a.createElement(Ue,{childProps:e})))}}]),t}(n.Component),Ve=Object(v.a)(_e);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Je=a(962),Ge=a(284),He={s3:{REGION:"eu-west-1",BUCKET:"innovation-unboxed-api-prod-auditdatabucket-fk1bqk4tg4ek"},apiGateway:{REGION:"eu-west-1",URL:"https://2swp18lpg5.execute-api.eu-west-1.amazonaws.com/prod"},cognito:{REGION:"eu-west-1",USER_POOL_ID:"eu-west-1_LJFdECv4X",APP_CLIENT_ID:"6v69u3gnaovvcljdeq4a7tlhh4",IDENTITY_POOL_ID:"eu-west-1:a10eab50-4fc7-46cc-ad1b-1ed38a762423"}},Me=Object(Ge.a)({},He);F.a.configure({Auth:{mandatorySignIn:!0,region:Me.cognito.REGION,userPoolId:Me.cognito.USER_POOL_ID,identityPoolId:Me.cognito.IDENTITY_POOL_ID,userPoolWebClientId:Me.cognito.APP_CLIENT_ID},Storage:{region:Me.s3.REGION,bucket:Me.s3.BUCKET,identityPoolId:Me.cognito.IDENTITY_POOL_ID},API:{endpoints:[{name:"audits",endpoint:Me.apiGateway.URL,region:Me.apiGateway.REGION}]}}),i.a.render(r.a.createElement(Je.a,null,r.a.createElement(Ve,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[285,2,1]]]);
//# sourceMappingURL=main.02d886b1.chunk.js.map